import{j as e,g as c,a as z}from"./admin-CjE1p_fZ.js";import{c as Q,r as o}from"./router-DqluUKdp.js";import{u as V,a as ee,n as te,F as P,S as T,o as se}from"./shop-NOs0Rz2B.js";import"./icons-CDVIwAiG.js";import"./charts-hD1MI6At.js";import"./vendor-Tt9FPAzf.js";import"./slick-JyPX3RhO.js";import"./stripe-DnwkPVAo.js";import"./auth-Tf0T-Vub.js";function xe(){const{id:d}=Q(),{addToCart:D}=V(),{wishlist:b,toggleWishlist:F}=ee(),[t,I]=o.useState(null),[L,j]=o.useState(0),[m,M]=o.useState(null),[x,Z]=o.useState(!1),[E,N]=o.useState(!0),[v,n]=o.useState(""),[w,y]=o.useState(0),[r,k]=o.useState(!1),[S,A]=o.useState({x:0,y:0}),[B,u]=o.useState(!1),[W,O]=o.useState(""),[h,Y]=o.useState(!1),g=o.useRef(null),f=o.useRef(null),p=()=>window.matchMedia("(max-width: 768px)").matches,_={dots:!1,infinite:!0,speed:300,slidesToShow:1,slidesToScroll:1,fade:!0,cssEase:"linear",beforeChange:(s,a)=>y(a)};o.useEffect(()=>{async function s(){N(!0),n("");try{const a=localStorage.getItem("token"),l=await z(`/commission/${d}`,{headers:a?{Authorization:`Bearer ${a}`}:{}}),i=await l.json();if(!l.ok)throw new Error(i.error||"Failed to load product");I(i),M(Number(i.avgRating)||null),j(i.userRating||0),Z(i.hasBought||!1)}catch(a){n(a.message)}finally{N(!1)}}s()},[d]);const q=async s=>{n("");try{const a=localStorage.getItem("token"),l=await z(`/commission/${d}/rate`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({rating:s})}),i=await l.json();if(!l.ok)throw new Error(i.error||"Failed to submit rating");j(s),n("Thank you for your rating!")}catch(a){n(a.message)}},U=s=>{y(s),g.current&&g.current.slickGoTo(s)},C=s=>{p()||(O(c(s)),u(!0),k(!1))},R=()=>{k(!r)},G=s=>{if(!r||!f.current)return;const{left:a,top:l,width:i,height:J}=f.current.getBoundingClientRect(),X=(s.clientX-a)/i*100,K=(s.clientY-l)/J*100;A({x:X,y:K})},H=t?.description?.length>70?t.description.substring(0,70)+"...":t?.description;if(E)return e.jsx("div",{className:"text-center py-20",children:"Loading..."});if(!t)return e.jsx("div",{className:"text-center py-20",children:"Product not found."});const $=t.images&&t.images.length>0?t.images:t.image?[t.image]:[];return e.jsxs("div",{className:"min-h-screen bg-white flex flex-col items-center justify-center px-4",children:[e.jsxs("div",{className:"max-w-6xl w-full flex flex-col md:flex-row items-center md:items-start gap-10 py-12",children:[e.jsxs("div",{className:"w-full md:w-1/2 flex flex-col justify-center items-center md:items-start order-2 md:order-1",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-center md:text-left",children:t.name}),t.partnerName&&e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.partnerLogo&&e.jsx("img",{src:c(t.partnerLogo),alt:t.partnerName,className:"w-8 h-8 rounded-full object-cover"}),e.jsx("span",{className:"text-lg font-medium text-pink-600",children:t.partnerName})]}),t.description&&e.jsxs("div",{className:"text-lg text-gray-700 mb-6 text-center md:text-left",children:[h?t.description:H,t.description?.length>70&&e.jsx("button",{className:"text-pink-600 dark:text-pink-400 ml-2 hover:underline font-medium",onClick:()=>Y(!h),children:h?"less":"more"})]}),e.jsx("div",{className:"text-2xl font-semibold text-gray-900 mb-8 text-center md:text-left",children:t.isDiscounted&&t.originalPrice?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"line-through text-red-500 text-lg",children:["€",t.originalPrice.toLocaleString()]}),e.jsxs("span",{className:"text-2xl font-semibold text-pink-600",children:["€",t.price.toLocaleString()]}),e.jsx("span",{className:"bg-red-500 text-white px-3 py-1 rounded text-sm font-medium w-fit",children:t.discountLabel||"Last Chance"})]}):e.jsxs("span",{className:"text-2xl font-semibold text-pink-600",children:["€",t.price.toLocaleString()]})}),t.commissionRate&&e.jsx("div",{className:"bg-pink-50 border border-pink-200 rounded-lg p-4 mb-6 w-full max-w-lg mx-auto md:mx-0",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-pink-600 font-medium mb-1",children:"Commission Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-pink-600",children:[t.commissionRate,"%"]}),e.jsx("div",{className:"text-xs text-[#171717] mt-1",children:"Earn commission on this product"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8 w-full max-w-lg mx-auto md:mx-0",children:[e.jsx("button",{onClick:()=>D({...t,quantity:1}),className:"flex-1 bg-[#DC2525] text-white px-6 py-3 rounded-lg font-semibold hover:bg-[#b71c1c] hover:scale-105 active:scale-95 transition-all duration-200",children:"Add to Cart"}),e.jsx("button",{onClick:()=>F(t._id),className:`flex-1 px-6 py-3 rounded-lg font-semibold transition-all duration-200 ${b.includes(t._id)?"bg-pink-500 text-gray-800 hover:bg-pink-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:b.includes(t._id)?"Remove from Wishlist":"Add to Wishlist"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-8 w-full max-w-lg mx-auto md:mx-0",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-bold text-[#171717]",children:"Category:"})," ",e.jsx("span",{className:"text-[#171717]",children:t.category||"-"})]}),t.partnerDescription&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-bold text-[#171717]",children:"Partner Description:"})," ",e.jsx("span",{className:"text-[#171717]",children:t.partnerDescription})]})]})]}),e.jsxs("div",{className:"w-full md:w-1/2 flex flex-row-reverse gap-6 order-1 md:order-2",children:[e.jsx("div",{className:"w-4/5 relative",children:e.jsx(te,{..._,initialSlide:w,ref:g,children:$.map((s,a)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c(s),alt:`${t.name} - ${a+1}`,className:"w-full h-auto max-h-[500px] object-contain rounded-lg shadow",style:{background:"#f8f8f8"},onClick:()=>C(s)}),!p()&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity duration-200 cursor-zoom-in",onClick:()=>C(s),children:e.jsx("div",{className:"bg-black bg-opacity-50 rounded-full p-3",children:e.jsx(P,{className:"text-gray-800 text-2xl"})})})]},a))})}),e.jsx("div",{className:"w-1/5 flex flex-col gap-4 overflow-y-auto max-h-[500px] pr-2",children:$.map((s,a)=>e.jsx("div",{className:`cursor-pointer transition-all duration-200 ${a===w?"border-2 border-gray-900":"border border-gray-300"} rounded-lg overflow-hidden`,onClick:()=>U(a),children:e.jsx("img",{src:c(s),alt:`Thumbnail ${a+1}`,className:"w-full h-full object-cover aspect-square"})},a))})]})]}),e.jsxs("div",{className:"flex flex-col items-center mt-2 mb-8",children:[e.jsxs("div",{className:"mb-2 flex flex-col items-center",children:[e.jsx("span",{className:"font-semibold mb-1",children:"Average rating:"}),e.jsx(T,{value:m||0,disabled:!0,onChange:()=>{},size:20}),e.jsx("span",{className:"text-xs text-[#171717] mt-1",children:m?`${m} / 5`:"No ratings yet"})]}),e.jsxs("div",{className:"mb-2 flex flex-col items-center",children:[e.jsx("span",{className:"font-semibold mb-1",children:"Your rating:"}),e.jsx(T,{value:L,onChange:x?q:()=>{},disabled:!x,size:20}),!x&&e.jsx("span",{className:"ml-2 text-xs text-[#171717]",children:"(You can only rate products you have purchased)"})]}),v&&e.jsx("div",{className:"mt-2 text-sm text-blue-600",children:v})]}),B&&!p()&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center p-4",onClick:()=>u(!1),children:e.jsxs("div",{className:"relative max-w-full max-h-full",onClick:s=>s.stopPropagation(),children:[e.jsx("img",{ref:f,src:W,alt:"Zoomed product",className:`max-w-[90vw] max-h-[90vh] object-contain transition-transform duration-200 ${r?"cursor-zoom-out":"cursor-zoom-in"}`,style:{transform:r?`scale(2) translate(${-S.x+50}%, ${-S.y+50}%)`:"none"},onClick:R,onMouseMove:G}),e.jsx("button",{className:"absolute top-4 right-4 bg-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg hover:bg-gray-100 transition",onClick:()=>u(!1),children:"×"}),e.jsx("button",{className:"absolute bottom-4 right-4 bg-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg hover:bg-gray-100 transition",onClick:R,children:r?e.jsx(se,{size:20}):e.jsx(P,{size:20})})]})})]})}export{xe as default};
